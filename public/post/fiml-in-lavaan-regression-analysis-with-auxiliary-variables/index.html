<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.55.1" />
  <meta name="author" content="William M. (Hank) Murrah, III">
  <meta name="description" content="Assistant Professor of Quantitative Methods">

  
  
  
  
    
  
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  


  

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-36666113-2', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="" type="application/rss+xml" title="Statistical Thinking">
  <link rel="feed" href="" type="application/rss+xml" title="Statistical Thinking">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/post/fiml-in-lavaan-regression-analysis-with-auxiliary-variables/">

  

  <title>FIML in Lavaan: Regression Analysis with Auxiliary Variables | Statistical Thinking</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Statistical Thinking</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#courses">
            
            <span>Courses</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#research">
            
            <span>Research</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">FIML in Lavaan: Regression Analysis with Auxiliary Variables</h1>
    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2019-04-17 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Apr 17, 2019
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/fiml-in-lavaan-regression-analysis-with-auxiliary-variables/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/missing-data">Missing Data</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=FIML%20in%20Lavaan%3a%20Regression%20Analysis%20with%20Auxiliary%20Variables&amp;url=%2fpost%2ffiml-in-lavaan-regression-analysis-with-auxiliary-variables%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2ffiml-in-lavaan-regression-analysis-with-auxiliary-variables%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2ffiml-in-lavaan-regression-analysis-with-auxiliary-variables%2f&amp;title=FIML%20in%20Lavaan%3a%20Regression%20Analysis%20with%20Auxiliary%20Variables"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2ffiml-in-lavaan-regression-analysis-with-auxiliary-variables%2f&amp;title=FIML%20in%20Lavaan%3a%20Regression%20Analysis%20with%20Auxiliary%20Variables"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=FIML%20in%20Lavaan%3a%20Regression%20Analysis%20with%20Auxiliary%20Variables&amp;body=%2fpost%2ffiml-in-lavaan-regression-analysis-with-auxiliary-variables%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      


<p>This is the third tutorial in a series that demonstrates how to us full information maximum likelihood (FIML) estimation using the R package <code>lavaan</code>. In this post, I demonstrate two methods of using auxiliary variable in a regression model with FIML. I am using data and examples from Craig Ender’s website <a href="http://www.appliedmissingdata.com/book-examples.html">Applied Missing Data</a>. The purpose of these posts is to make the examples on Craig’s website, which uses Mplus, available to those who prefer to use <code>lavaan</code></p>
<p>Mplus allows you to use auxiliary variable when using FIML to include variables that help estimate missing values with variables that are not part of the analytic model. There may be variables that are correlated with variables with missing values or variables that are predictive of missing. However, these auxiliary variable are not part of the model you wish to estimate. See Craig’s book <a href="http://www.amazon.com/Applied-Missing-Analysis-Methodology-Sciences/dp/1606236393/ref=sr_1_1?ie=UTF8&amp;qid=1402932586&amp;sr=8-1&amp;keywords=applied%20missing%20data%20analysis">Applied Missing Data Analysis</a> for more information about auxiliary variables.</p>
<p>I attended a workshop where Craig showed us how to use the auxiliary command in Mplus to make use of auxiliary variables. However, <code>lavaan</code> does not have this option. He also showed us what he called a ‘brute force’ method to include auxiliary variables in Mplus. Here is how to do it in <code>lavaan</code>.</p>
<div id="brute-force-method" class="section level2">
<h2>Brute Force Method</h2>
<p>This model is the same as used in my last post, where <strong>job performance</strong> (jobperf) is regressed on <strong>wellbeing</strong> (wbeing) and <strong>job satisfaction</strong> (jobsat). In this example these three variables are the only ones which we want to model. However, <strong>tenure</strong> and <strong>IQ</strong> are related to missingness in these variables. So, we want to use them to help us better estimate our model of interest. If we included them as predictors in the regression model, it would allow us to use all the available information in these five variables, but it would change the model substantially. We can use auxiliary variables to better estimate the original model.</p>
<div id="import-data" class="section level3">
<h3>Import Data</h3>
<p>First we import data, name the variables, and recode the -99’s to <code>NA</code>.</p>
<pre><code># employeeAuxiliary.R ---------------------------------------------------

# R packages used
library(lavaan)
# Import text file into R as a data frame.

employee &lt;- read.table(&quot;path/to/file/employee.dat&quot;)

# Assign names to variables.

names(employee) &lt;- c(&quot;id&quot;, &quot;age&quot;, &quot;tenure&quot;, &quot;female&quot;, &quot;wbeing&quot;, &quot;jobsat&quot;, 
                 &quot;jobperf&quot;, &quot;turnover&quot;, &quot;iq&quot;)

# Replace all missing values (-99) with R missing value character &#39;NA&#39;.
employee[employee==-99] &lt;- NA</code></pre>
</div>
<div id="create-regression-model-object-brute-force" class="section level3">
<h3>Create Regression Model Object (Brute Force)</h3>
<p>Basically, the brute force method entails correlating the auxiliary variables with other auxiliary variable, the predictors, and the residuals for the outcome variable.</p>
<pre><code># The b1* and b2* are labels used in the Wald test below
model &lt;- &#39;
jobperf ~ b1*wbeing + b2*jobsat
wbeing ~~ jobsat
wbeing ~~ turnover + iq
jobsat ~~ turnover + iq
jobperf ~~ turnover + iq
turnover ~~ iq
&#39;</code></pre>
</div>
<div id="fit-and-summarize-the-model" class="section level3">
<h3>Fit and Summarize the Model</h3>
<pre><code>fit &lt;- sem(model, employee, missing=&#39;fiml&#39;, fixed.x=FALSE, 
           meanstructure=TRUE)
summary(fit, fit.measures=TRUE, rsquare=T, standardize=T)</code></pre>
</div>
<div id="wald-test" class="section level3">
<h3>Wald test</h3>
<p>Just as we did in the previous post.</p>
<pre><code>lavTestWald(fit, 
            &#39;b1 == 0
             b2 == 0&#39;)</code></pre>
</div>
</div>
<div id="using-auxiliary-command-in-semtools" class="section level2">
<h2>Using <strong>auxiliary</strong> Command in <code>semTools</code></h2>
<p>First, load the <strong>semTools</strong> package</p>
<pre><code>library(semTools)</code></pre>
<div id="create-regression-model-object" class="section level3">
<h3>Create Regression Model Object</h3>
<p>Next, create a model object with just the model of interest</p>
<pre><code>model2 &lt;- &#39;
jobperf ~ wbeing + jobsat
&#39;</code></pre>
<p>Then, create a vector of the names of the auxiliary variables</p>
<pre><code>aux.vars &lt;- c(&#39;turnover&#39;, &#39;iq&#39;)</code></pre>
</div>
<div id="fit-the-model" class="section level3">
<h3>Fit the Model</h3>
<p>Then, fit the model to the new model object.</p>
<pre><code>fit2 &lt;- sem(model2, employee, missing=&#39;fiml&#39;, meanstructure=TRUE, fixed.x=FALSE)</code></pre>
<p>Using this model object, fit another model that incorporates the auxiliary variables using the <strong>sem.auxiliary</strong> function from the <code>semTools</code> package.</p>
<pre><code>auxfit &lt;- sem.auxiliary(model=fit2, aux=aux.vars, data=employee)
</code></pre>
<p>Finally, summarize the model object that includes the auxiliary variables.</p>
<pre><code>summary(auxfit, fit.measures=TRUE, rsquare=TRUE, standardize=TRUE)</code></pre>
<p>There you have it! Two way to use auxiliary variables in a regression model using <code>lavaan</code>.</p>
</div>
</div>

    </div>

    
    
    
    <div class="article-tags">
      
      <a class="btn btn-primary btn-outline" href="/tags/erma7310">ERMA7310</a>
      
    </div>
    
    

  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/fiml-regression/">FIML in Lavaan: Regression Analysis</a></li>
    
    <li><a href="/post/fiml-in-lavaan-descriptive-statistics/">FIML in Lavaan: Descriptive Statistics</a></li>
    
    <li><a href="/project/da2/">ERMA 7310: Design and Analysis II</a></li>
    
    <li><a href="/post/fiml-regression-auxiliary/">FIML in Lavaan: Regression Analysis with Auxiliary Variables</a></li>
    
  </ul>
</div>




<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "statistical-thinking" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 William Murrah &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    

    
    
    <script id="dsq-count-scr" src="//statistical-thinking.disqus.com/count.js" async></script>
    

    
    <script async defer src="//maps.googleapis.com/maps/api/js?key=AIzaSyBNrEFFN9mUmRs4enTvhQdfXz8TrVGZmII"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

