<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.29" />
  <meta name="author" content="William M. (Hank) Murrah, III">
  <meta name="description" content="Assistant Professor of Quantitative Methods">

  
  
  
  
    
  
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  


  

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-36666113-2', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="" type="application/rss+xml" title="Statistical Conditioning">
  <link rel="feed" href="" type="application/rss+xml" title="Statistical Conditioning">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/post/factorial-anova-two-way-between-subjects-anova/">

  

  <title>Factorial Anova: Two-Way Between Subjects ANOVA | Statistical Conditioning</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Statistical Conditioning</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#courses">
            
            <span>Courses</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Factorial Anova: Two-Way Between Subjects ANOVA</h1>
    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-11-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Nov 27, 2017
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    5 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/factorial-anova-two-way-between-subjects-anova/#disqus_thread"></a>
  

  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Factorial%20Anova%3a%20Two-Way%20Between%20Subjects%20ANOVA&amp;url=%2fpost%2ffactorial-anova-two-way-between-subjects-anova%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2ffactorial-anova-two-way-between-subjects-anova%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2ffactorial-anova-two-way-between-subjects-anova%2f&amp;title=Factorial%20Anova%3a%20Two-Way%20Between%20Subjects%20ANOVA"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2ffactorial-anova-two-way-between-subjects-anova%2f&amp;title=Factorial%20Anova%3a%20Two-Way%20Between%20Subjects%20ANOVA"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Factorial%20Anova%3a%20Two-Way%20Between%20Subjects%20ANOVA&amp;body=%2fpost%2ffactorial-anova-two-way-between-subjects-anova%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <pre class="r"><code>library(knitr)
library(AMCP)
library(car)
library(pander)
library(ztable)</code></pre>
<pre><code>## Welcome to package ztable ver 0.1.5</code></pre>
<pre class="r"><code>library(emmeans)
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.3.4     ✔ dplyr   0.7.4
## ✔ tidyr   0.7.2     ✔ stringr 1.2.0
## ✔ readr   1.1.1     ✔ forcats 0.2.0</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ✖ dplyr::recode() masks car::recode()
## ✖ purrr::some()   masks car::some()</code></pre>
<pre class="r"><code>opts_chunk$set(echo = TRUE, comment = NULL, highlight = FALSE)
options(ztable.type = &quot;html&quot;)
options(scipen=1, digits=3)

data(C7T5)
df &lt;- within(C7T5, {
  Feedback &lt;- factor(Feedback)
  Drug     &lt;- factor(Drug)
})</code></pre>
<div id="anova" class="section level1">
<h1>ANOVA</h1>
<p>Some text.</p>
<pre class="text"><code>mod &lt;- lm(Score ~ Feedback*Drug, df)
summary(mod)</code></pre>
<pre><code>
Call:
lm(formula = Score ~ Feedback * Drug, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-20.00  -8.75  -1.50  10.75  18.00 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       170.00       5.58   30.46  &lt; 2e-16 ***
Feedback2          16.00       7.89    2.03  0.05390 .  
Drug2              33.00       7.89    4.18  0.00033 ***
Drug3              18.00       7.89    2.28  0.03175 *  
Feedback2:Drug2   -18.00      11.16   -1.61  0.11992    
Feedback2:Drug3     6.00      11.16    0.54  0.59586    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 12.5 on 24 degrees of freedom
Multiple R-squared:  0.585, Adjusted R-squared:  0.499 
F-statistic: 6.78 on 5 and 24 DF,  p-value: 0.000453</code></pre>
<pre class="text"><code>avmod &lt;- aov(mod)
summary(avmod)</code></pre>
<pre><code>          Df Sum Sq Mean Sq F value  Pr(&gt;F)    </code></pre>
<p>Feedback 1 1080 1080 6.93 0.01456 *<br />
Drug 2 3420 1710 10.98 0.00041 *** Feedback:Drug 2 780 390 2.50 0.10288<br />
Residuals 24 3738 156<br />
— Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ‘’ 1</p>
</div>
<div id="other-stuff" class="section level1">
<h1>Other stuff</h1>
<pre class="text"><code>emmeans(mod, &quot;Drug&quot;)</code></pre>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code> Drug emmean   SE df lower.CL upper.CL
 1       178 3.95 24      170      186
 2       202 3.95 24      194      210
 3       199 3.95 24      191      207

Results are averaged over the levels of: Feedback 
Confidence level used: 0.95 </code></pre>
<pre class="text"><code>emmeans(mod, &quot;Feedback&quot;)</code></pre>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code> Feedback emmean   SE df lower.CL upper.CL
 1           187 3.22 24      180      194
 2           199 3.22 24      192      206

Results are averaged over the levels of: Drug 
Confidence level used: 0.95 </code></pre>
<pre class="text"><code>emmip(mod, Feedback ~ Drug)</code></pre>
<p><img src="/post/2017-11-27-factorial-anova-two-way-between-subjects-anova_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="text"><code>emmip(mod, Drug ~ Feedback)</code></pre>
<p><img src="/post/2017-11-27-factorial-anova-two-way-between-subjects-anova_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="text"><code>emmod &lt;- emmeans(mod, pairwise ~ Drug)</code></pre>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre class="text"><code>emmod</code></pre>
<pre><code>$emmeans
 Drug emmean   SE df lower.CL upper.CL
 1       178 3.95 24      170      186
 2       202 3.95 24      194      210
 3       199 3.95 24      191      207

Results are averaged over the levels of: Feedback 
Confidence level used: 0.95 

$contrasts
 contrast estimate   SE df t.ratio p.value
 1 - 2         -24 5.58 24  -4.300  0.0007
 1 - 3         -21 5.58 24  -3.763  0.0027
 2 - 3           3 5.58 24   0.538  0.8537

Results are averaged over the levels of: Feedback 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
<p>More text.</p>
<div class="alert alert-note">
  <p>Can this note contain <code>code</code></p>

</div>

<div id="another-example" class="section level2">
<h2>another Example</h2>
<pre class="text"><code>n = 25
Beta_0 = 70 # 80
Beta_tx = 10 # 9
Beta_sch = 15 # 15
Beta_ab = -12 # -12

Tx &lt;- rep(c(0, 1, 0, 1), each = n)
Sch &lt;- rep(c(0, 1), each = 2*n)
set.seed(20171024)
y &lt;- Beta_0 + Beta_tx*Tx + Beta_sch*Sch + Beta_ab*Tx*Sch + rnorm(2*n, 0, 15)
df &lt;- data.frame(y = round(y, 1), 
                 Tx = factor(Tx, labels = c(&quot;control&quot;, &quot;treatment&quot;)), 
                 Sch = factor(Sch, labels = c(&quot;public&quot;, &quot;private&quot;)))</code></pre>
<pre class="text"><code>df %&gt;% 
  group_by(Tx) %&gt;% 
  summarise(Mean_y = mean(y),
            SD_y = sd(y))</code></pre>
<pre><code># A tibble: 2 x 3
         Tx Mean_y  SD_y
     &lt;fctr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1   control   74.2  18.0
2 treatment   82.3  12.5</code></pre>
<pre class="text"><code>df %&gt;% 
  group_by(Sch) %&gt;% 
  summarise(mean_y = mean(y),
            SD_y = sd(y))</code></pre>
<pre><code># A tibble: 2 x 3
      Sch mean_y  SD_y
   &lt;fctr&gt;  &lt;dbl&gt; &lt;dbl&gt;
1  public   73.7  16.1
2 private   82.7  14.5</code></pre>
<pre class="text"><code>mod &lt;- lm(y ~ Tx*Sch, df)
summary(mod)</code></pre>
<pre><code>
Call:
lm(formula = y ~ Tx * Sch, data = df)

Residuals:
   Min     1Q Median     3Q    Max 
-30.26 -10.56  -0.63   9.64  40.19 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               66.71       2.92   22.84  &lt; 2e-16 ***
Txtreatment               14.05       4.13    3.40  0.00098 ***
Schprivate                15.00       4.13    3.63  0.00045 ***
Txtreatment:Schprivate   -12.00       5.84   -2.05  0.04265 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 14.6 on 96 degrees of freedom
Multiple R-squared:  0.182, Adjusted R-squared:  0.156 
F-statistic:  7.1 on 3 and 96 DF,  p-value: 0.000232</code></pre>
<pre class="text"><code>anova(mod)</code></pre>
<pre><code>Analysis of Variance Table

Response: y
          Df Sum Sq Mean Sq F value Pr(&gt;F)   
Tx         1   1619    1619    7.59 0.0070 **
Sch        1   2025    2025    9.50 0.0027 **
Tx:Sch     1    900     900    4.22 0.0427 * 
Residuals 96  20471     213                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="text"><code>emmeans(mod, &quot;Sch&quot;)</code></pre>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code> Sch     emmean   SE df lower.CL upper.CL
 public    73.7 2.07 96     69.6     77.8
 private   82.7 2.07 96     78.6     86.8

Results are averaged over the levels of: Tx 
Confidence level used: 0.95 </code></pre>
<pre class="text"><code>pmmip(mod, Tx ~ Sch)  + ylim(0, 100)</code></pre>
<p><img src="/post/2017-11-27-factorial-anova-two-way-between-subjects-anova_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="text"><code>pmmip(mod, Sch ~ Tx)  + ylim(0, 100)</code></pre>
<p><img src="/post/2017-11-27-factorial-anova-two-way-between-subjects-anova_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="controling-familywise-alpha-level-in-factorial-anova" class="section level2">
<h2>Controling Familywise Alpha level in Factorial ANOVA</h2>
</div>
<div id="measuring-effects" class="section level2">
<h2>Measuring Effects</h2>
<p><span class="math display">\[
R^2_{\text{partial}} = \frac{SS_{\text{effect}}}{SS_W + SS_{\text{effect}}}
\]</span></p>
<p><span class="math display">\[
R^2_{\text{A,partial}} = \frac{SS_A}{SS_W + SS_A}
\]</span> <span class="math display">\[
R^2_{\text{AB, partial}} = \frac{SS_{AB}}{SS_W + SS_{AB}}
\]</span></p>
<p>For type of drug:</p>
<p><span class="math display">\[
R^2_{\text{drug,partial}} = \frac{SS_{\text{drug}}}{SS_W + SS_{\text{drug}}} = \frac{3420}{3738 + 3420} = 0.48
\]</span> ## Follow-up Analyses</p>
<div id="futher-main-effects-analyses" class="section level3">
<h3>Futher Main Effects Analyses</h3>
</div>
<div id="exploring-interactions-with-simple-effects" class="section level3">
<h3>Exploring Interactions with Simple Effects</h3>
</div>
</div>
</div>

    </div>

    
    
    
    <div class="article-tags">
      
      <a class="btn btn-primary btn-outline" href="/tags/erma7300">ERMA7300</a>
      
    </div>
    
    

  </div>

</article>



<div class="article-container article-widget">
  <div class="hr-light"></div>
  <h3>Related</h3>
  <ul>
    
    <li><a href="/post/one-way-anova/">One Way ANOVA </a></li>
    
    <li><a href="/post/getting-started/">Getting Started</a></li>
    
    <li><a href="/post/variability/">Variability</a></li>
    
    <li><a href="/post/effects-size-estimates/">Effects Size Estimates</a></li>
    
    <li><a href="/post/getting-data-into-spss-and-r/">Getting Data Into SPSS and R</a></li>
    
  </ul>
</div>




<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "statisticalconditioning" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 William Murrah &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    

    
    
    <script id="dsq-count-scr" src="//statisticalconditioning.disqus.com/count.js" async></script>
    

    
    <script async defer src="//maps.googleapis.com/maps/api/js?key=AIzaSyBNrEFFN9mUmRs4enTvhQdfXz8TrVGZmII"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

